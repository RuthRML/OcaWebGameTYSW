<html>
<head>
<meta name="google-signin-client_id" content="808186466447-qkcbf15u53sou7hfn9un20olkmr83i6c.apps.googleusercontent.com">
<title>Registro Oca</title>

<!--  <script src=”https://apis.google.com/js/client:plusone.js”></script >
-->
<script src=http://code.jquery.com/jquery-1.10.1.min.js></script>

<script type="text/javascript">
function registro() {
    
    var req=emailRegistro=document.getElementById("emailRegistro").value;
    //var req=nombreUsuario=document.getElementById("nombreUsuario").value;
    var pass1=document.getElementById("pwd1").value;
    var pass2=document.getElementById("pwd2").value;
    //var idSession=document.getElementById("idSession").value;
    var divRegistro=document.getElementById("divRegistro");
    var mensajeRegistro=document.getElementById("divRegistro");
    
    var reqRegistrar=new XMLHttpRequest();
    
    reqRegistrar.open("post", "Registrar.jsp");
    reqRegistrar.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    reqRegistrar.onreadystatechange = function() {
        if (reqRegistrar.readyState==4) {
            if (reqRegistrar.status==200) {
                var result=JSON.parse(reqRegistrar.responseText);
                if (result.resultado=="OK") {
                	
                	document.getElementById("nombreUsuario").value="";
                    document.getElementById("email").value="";
                    document.getElementById("pwd1").value="";
                    document.getElementById("pwd2").value="";
                    alert("Registro exitoso, " + emailRegistro);
                    divRegistro.style="display:none";
                } else {
                	console.log(result);
                    alert("Error: " + result.mensaje);
                    mensajeRegistro.innerHTML=result.resultado;
                }
            } else {
                alert("Algo pasa");
            }
        }
        };
        var p = {
        		//nombreUsuario : nombreUsuario,
        		email: emailRegistro,
        		pwd1: pass1,
        		pwd2: pass2
        	};
        
    
    reqRegistrar.send("p="+JSON.stringify(p));
    }




</script>



</head>
<body>

<div id="my-signin2" data-width="300" data-height="200" data-longtitle="true">></div>
  <script>
    function onSuccess(googleUser) {
      console.log('Logged in as: ' + googleUser.getBasicProfile().getName());
      console.log('Email:  ' + googleUser.getBasicProfile().getEmail());
    }
    function onFailure(error) {
      console.log(error);
    }
    function renderButton() {
      gapi.signin2.render('my-signin2', {
        'scope': 'profile email',
        'width': 240,
        'height': 50,
        'longtitle': true,
        'theme': 'dark',
        'onsuccess': onSuccess,
        'onfailure': onFailure
      });
    }
  </script>

  <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
<div class="container" id="divRegistro">

    <form action="Registrar.jsp" method="post">
        <label for="emailRegistro">email:</label><input type="text" id="emailRegistro" name="emailRegistro" maxlength="45" /><br/>
        <label for="pwd1">Password:</label><input type="password" id="pwd1" name="pwd1"/><br/>
        <label for="pwd2">Repite password:</label> <input type="password" id="pwd2" name="pwd2" /><br/>
        <!-- <input type="submit" name="boton" value="Aceptar"/>
        -->
    </form>
    
    <input type="button" value="Registrar" onclick="registro()">
    <span id="mensajeRegistro"></span>
    </div>
</body>
</html>
